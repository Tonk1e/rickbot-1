{% extends 'full-page.html' %}
{% block content %}
<div class="jumbotron home-jumbotron">
  <div class="container">
    <div class="row">
        <div class="col-md-4 col-md-offset-4 animated bounceInDown text-center">
            <img src="{{ url_for('static', filename='img/rick.png') }}">
            <h3>Select a <img src="{{ url_for('static', filename='img/discord-logo.svg') }}" class="discord-logo2"> server : </h3>
            <div class="form-group">
                {% if user_servers %}
                <select class="form-control" id="select">
                    <option value="">Which server? Make your choice ;)</option>
                    {% for server in user_servers %}
                    <option value='{{url_for('dashboard', server_id=server['id'])}}'>{{server['name']}}</option>
                    {% endfor %}
                 </select>

                 <script>
                    $("#select").change(function () {
                        var val = jQuery(this).val();
                        if val(!=''){
                          var watch = true;
                          var win = window.open(jQuery(this).val())
                          setTimeout(function(){
                            console.log(win.location.hostname)
                            console.log(window.location.hostname)
                            if(win.location.hostname==window.location.hostname)
                              watch = false
                          }, 2000)
                          var check = function(){
                            if(win.closed && watch)
                              location.href = val;
                          }
                          setInterval(check, 300)
                        }
                    })
                 </script>

                 {% else %}
                 <h3>...Ah. It looks like you don't have any server!</h3>
                 <h3>Go ahead and create one! <br/>I'm waiting for you ;) </h3>
                 {% endif %}
            </div>
        </div>
    </div>

  </div>
</div>
{% endblock %}
